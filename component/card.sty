\RequirePackage{graphicx}

% 10.5cm x 5.45cm

\setlength{\fboxrule}{0pt}
\setlength{\fboxsep}{1.25em}

% Card
\newsavebox{\mybox}
\newenvironment{BHHCard}[4]{%
  \def\imgcmd{\includegraphics[width=5.45cm]{img/#4_background.png}}%
  \begin{lrbox}{\mybox}%
    \begin{minipage}[t][\dimexpr10.5cm-2\fboxsep-2\fboxrule\relax]{\dimexpr5.45cm-2\fboxsep-2\fboxrule\relax}%
      ~\par%
      { \centering%
        {\FontTitle \LARGE #1} \par%
        {\FontSubTitle \small \textcolor{milk-dark}{\uppercase{#2}}} \par%
      }%
      \vspace*{0.5em}%
      \small%
}{%
    \end{minipage}%
  \end{lrbox}%
  %
  \sbox\mybox{\fbox{\usebox\mybox}}%
  \mbox{%
    \rlap{\raisebox{\dimexpr-\dp\mybox}{\imgcmd}}%
    \usebox\mybox%
  }%
}

% Card Story
\newenvironment{CardStory}{%
  \centering \FontStory \footnotesize%
}{%
  \par\vspace*{-0.5em}%
  \hfil{\textcolor{milk-dark}{\rule{\textwidth}{0.4pt}}}\hfil%
}

% Event Card
\newenvironment{EventCard}[3]{%
  \begin{BHHCard}{#3}{#2}{#1}{event}%
}{%
  \end{BHHCard}%
}

% Item Card
\newenvironment{ItemCard}[2]{%
  \def\ThisName{\ItemBrief{#2}}
  \begin{BHHCard}{\ThisName}{#2}{#1}{item}%
}{%
  \end{BHHCard}%
}

% Omen Card
\newenvironment{OmenCard}[2]{%
  \def\ThisName{\OmenBrief{#2}}
  \begin{BHHCard}{\ThisName}{#2}{#1}{omen}%
}{%
  \end{BHHCard}%
}
